<%- include("../partials/header")%>
    <%- include("../partials/navbar")%>

        <div class="container" style="margin-top: 5rem;">

            <%- include("../partials/flash")%>

                <h6 class="display-6">My Cart</h6>

                <div class="row">
                    <div class="col-lg-8">

                        <%for(let item of userCart){%>
                            <div class="card mb-3" style="width: 90%;">
                                <div class="row g-0">
                                    <div class="col-md-4">
                                        <img style="width: 200px;" src="<%=item.img%>" alt="...">
                                    </div>
                                    <div class="col-md-8">
                                        <div class="card-body">
                                            <h5 class="card-title">
                                                <%=item.name%>
                                            </h5>

                                            <h7 class="card-title">
                                                <%=item.price%>
                                            </h7>

                                            <form action="/user/<%=currentUser._id%>/cart/<%=item._id%>?_method=DELETE" method="post">
                                                <button class="btn btn-sm btn-danger">remove</button>
                                            </form>


                                        </div>
                                    </div>
                                </div>
                            </div>
                            <%}%>


                    </div>

                    <div class="col-lg-4 mb-3">
                        <%totalAmount=0%>
                            <h6 class="display-6">Products</h6>
                            <ul class="list-group">

                                <%for(let item of userCart){%>
                                    <li class="list-group-item">
                                        <%=item.name%> - <strong>&#8377; <%=item.price%></strong></li>
                                    <%totalAmount+=item.price%>
                                        <%}%>

                            </ul>

                            <div class="mt-2">
                                <p class="fw-bold">Total Amount : &#8377;
                                    <%=totalAmount%>
                                </p>
                                <a href="/cart/payment" class="btn btn-success">Proceed To Pay</a>
                            </div>

                    </div>

                </div>

        </div>


        <footer class="footer py-3 mt-auto text-black text-center fixed-bottom" style="background-color: rgb(243, 234, 114);width: 100%;">
            <div class="container">
                <h4>&copy; shopping-cart 2021</h4>
            </div>
        </footer>


        <script>
            (function() {
                'use strict'

                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                const forms = document.querySelectorAll('.validated-form')

                // Loop over them and prevent submission
                Array.prototype.slice.call(forms)
                    .forEach(function(form) {
                        form.addEventListener('submit', function(event) {
                            if (!form.checkValidity()) {
                                event.preventDefault()
                                event.stopPropagation()
                            }

                            form.classList.add('was-validated')
                        }, false)
                    })
            })()
        </script>


        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>
        </body>

        </html>